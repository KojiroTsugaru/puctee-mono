# Cascade AI Coding Rules for Puctee Monorepo

This file contains rules that the Cascade AI coding assistant must follow when working on this project.

## üìù Commit Message Convention

### Format
All commits MUST follow this format:
```
<scope>: <subject>

[optional body]

[optional footer]
```

### Required Scopes
- **`ios:`** - Changes to the iOS application (`puctee-ios/`)
- **`backend:`** - Changes to the FastAPI backend (`puctee-backend/`)
- **`docs:`** - Documentation changes (README files, comments)
- **`chore:`** - Maintenance tasks (dependencies, configs, scripts)
- **`ci:`** - CI/CD pipeline changes
- **`test:`** - Adding or updating tests (backend or iOS)

### Subject Rules
1. Use imperative mood ("add" not "added" or "adds")
2. Don't capitalize first letter
3. No period at the end
4. Maximum 72 characters
5. Be specific and descriptive

### Examples

‚úÖ **Correct:**
```
ios: add trust stats ring animation to profile view
backend: implement penalty approval endpoint
ios: fix location permission crash on iOS 17
backend: update SQLAlchemy to 2.0.25
docs: add monorepo setup instructions to root README
chore: update iOS deployment target to 16.0
test: add unit tests for friend service
```

‚ùå **Incorrect:**
```
update                          # Too vague, no scope
Fixed bug                       # No scope, wrong tense, capitalized
iOS: Added new feature          # Capitalized scope, wrong tense
backend stuff                   # Not descriptive
```

### Special Cases

**Multi-scope changes:**
```
ios+backend: add location sharing websocket feature
```

**Breaking changes:**
```
backend!: change authentication token format to JWT
```

## üé® Code Style Rules

### Swift/iOS
- Use SwiftUI over UIKit when possible
- Follow Swift API Design Guidelines
- Prefer `guard let` over optional chaining for early returns
- Use meaningful variable names (no single letters except in loops)
- Add `// MARK: -` comments to organize code sections
- Maximum line length: 120 characters

### Python/Backend
- Follow PEP 8 style guide
- Use type hints for all function parameters and return values
- Maximum line length: 100 characters
- Use async/await for all database operations
- Prefer f-strings over `.format()` or `%` formatting
- Add docstrings to all public functions and classes

## üìÅ File Organization

### When Creating New Files
- iOS: Place in appropriate subdirectory under `puctee-ios/puctee/`
- Backend: Follow existing structure in `puctee-backend/app/`
- Tests: Place in corresponding test directories

### Import Organization
- **Swift**: Group imports (Foundation, SwiftUI, third-party)
- **Python**: Standard library, third-party, local imports (separated by blank lines)

## üß™ Testing Rules

- Never commit code without ensuring existing tests pass
- Add tests for new features when possible
- Backend: Use pytest fixtures for database setup
- iOS: Use XCTest framework

## üö´ Never Do

- Don't commit `.env` files (only `.env.example`)
- Don't hardcode API keys or secrets
- Don't use force unwrapping (`!`) in Swift without good reason
- Don't commit commented-out code (remove it)
- Don't commit debug print statements
- Don't modify `.gitignore` to include files that should be ignored

## ‚úÖ Always Do

- Stage only relevant files for each commit
- Use the correct scope prefix in commit messages
- Run tests before committing (when applicable)
- Update documentation when changing APIs
- Ask for clarification if commit scope is unclear

---

**Last Updated:** October 19, 2025
